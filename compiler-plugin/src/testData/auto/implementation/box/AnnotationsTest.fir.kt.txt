package auto.implementation.box

open annotation class TestAnnotation : Annotation {
  val a: Int
    field = a
    get

  constructor(a: Int) /* primary */ {
    super/*Any*/()
    /* <init>() */

  }

}

@TestAnnotation(a = 1)
class Test {
  @TestAnnotation(a = 2)
  @ExternalAnnotation(name = "test", type = List<*>::class)
  val prop: Int
    field = 2
    get

  constructor() /* primary */ {
    super/*Any*/()
    /* <init>() */

  }

  fun test(@TestAnnotation(a = 3) a: Int = 3): String {
    return ""
  }

}

fun box(): String {
  val spekt: Inspektion<Test> = InspektionResultV1</* null */>(kClass = Test::class, isAbstract = false, packageNames = arrayOf<String>(elements = ["auto", "implementation", "box"]), classNames = arrayOf<String>(elements = ["Test"]), supertypes = arrayOf<KType>(elements = [typeOf<Any>()]), annotations = arrayOf<Annotation>(elements = [TestAnnotation(a = 1)]), functions = arrayOf<Function>(elements = [Function(packageNames = arrayOf<String>(elements = ["auto", "implementation", "box"]), classNames = arrayOf<String>(elements = ["Test"]), name = "test", isAbstract = false, kotlin = Test::test, annotations = arrayOf<Annotation>(elements = []), parameters = arrayOf<Param>(elements = [Param(name = "<this>", annotations = arrayOf<Annotation>(elements = []), hasDefault = false, type = typeOf<Test>(), globalIndex = 0, indexInKind = 0, kind = 0), Param(name = "a", annotations = arrayOf<Annotation>(elements = [TestAnnotation(a = 3)]), hasDefault = true, type = typeOf<Int>(), globalIndex = 1, indexInKind = 0, kind = 3)]), returnType = typeOf<String>(), isSuspend = false, isPrimaryCtor = false, invoker = local fun <anonymous>(args: ArgumentsProviderV1): Any? {
    val tmp_0: Int = args.<get-v1DefaultableHasValueBitmask>()
    return when {
      EQEQEQ(arg0 = tmp_0, arg1 = 0) -> args.v1Get(globalIndex = 0) as Test.test()
      EQEQEQ(arg0 = tmp_0, arg1 = 1) -> args.v1Get(globalIndex = 0) as Test.test(a = args.v1Get(globalIndex = 1) as Int)
      else -> args.throwInvalidBitmask()
    }
  }
, suspendInvoker = null, inheritedFrom = null, typeParameters = arrayOf<TypeParameter>(elements = [])), Function(packageNames = arrayOf<String>(elements = ["auto", "implementation", "box"]), classNames = arrayOf<String>(elements = ["Test"]), name = "equals", isAbstract = false, kotlin = Test::equals, annotations = arrayOf<Annotation>(elements = []), parameters = arrayOf<Param>(elements = [Param(name = "<this>", annotations = arrayOf<Annotation>(elements = []), hasDefault = false, type = typeOf<Any>(), globalIndex = 0, indexInKind = 0, kind = 0), Param(name = "other", annotations = arrayOf<Annotation>(elements = []), hasDefault = false, type = typeOf<Any?>(), globalIndex = 1, indexInKind = 0, kind = 3)]), returnType = typeOf<Boolean>(), isSuspend = false, isPrimaryCtor = false, invoker = local fun <anonymous>(args: ArgumentsProviderV1): Any? {
    return args.v1Get(globalIndex = 0) as Any.equals(other = args.v1Get(globalIndex = 1) as Any?)
  }
, suspendInvoker = null, inheritedFrom = Any::class, typeParameters = arrayOf<TypeParameter>(elements = [])), Function(packageNames = arrayOf<String>(elements = ["auto", "implementation", "box"]), classNames = arrayOf<String>(elements = ["Test"]), name = "hashCode", isAbstract = false, kotlin = Test::hashCode, annotations = arrayOf<Annotation>(elements = []), parameters = arrayOf<Param>(elements = [Param(name = "<this>", annotations = arrayOf<Annotation>(elements = []), hasDefault = false, type = typeOf<Any>(), globalIndex = 0, indexInKind = 0, kind = 0)]), returnType = typeOf<Int>(), isSuspend = false, isPrimaryCtor = false, invoker = local fun <anonymous>(args: ArgumentsProviderV1): Any? {
    return args.v1Get(globalIndex = 0) as Any.hashCode()
  }
, suspendInvoker = null, inheritedFrom = Any::class, typeParameters = arrayOf<TypeParameter>(elements = [])), Function(packageNames = arrayOf<String>(elements = ["auto", "implementation", "box"]), classNames = arrayOf<String>(elements = ["Test"]), name = "toString", isAbstract = false, kotlin = Test::toString, annotations = arrayOf<Annotation>(elements = []), parameters = arrayOf<Param>(elements = [Param(name = "<this>", annotations = arrayOf<Annotation>(elements = []), hasDefault = false, type = typeOf<Any>(), globalIndex = 0, indexInKind = 0, kind = 0)]), returnType = typeOf<String>(), isSuspend = false, isPrimaryCtor = false, invoker = local fun <anonymous>(args: ArgumentsProviderV1): Any? {
    return args.v1Get(globalIndex = 0) as Any.toString()
  }
, suspendInvoker = null, inheritedFrom = Any::class, typeParameters = arrayOf<TypeParameter>(elements = []))]), properties = arrayOf<Property>(elements = [Property(packageNames = arrayOf<String>(elements = ["auto", "implementation", "box"]), classNames = arrayOf<String>(elements = ["Test"]), name = "prop", annotations = arrayOf<Annotation>(elements = [TestAnnotation(a = 2), ExternalAnnotation(name = "test", type = List<*>::class)]), isMutable = false, hasBackingField = true, isAbstract = false, hasDelegate = false, type = typeOf<Int>(), kotlin = Test::prop, getter = Function(packageNames = arrayOf<String>(elements = ["auto", "implementation", "box"]), classNames = arrayOf<String>(elements = ["Test"]), name = "<get-prop>", isAbstract = false, kotlin = Test::<get-prop>, annotations = arrayOf<Annotation>(elements = []), parameters = arrayOf<Param>(elements = [Param(name = "<this>", annotations = arrayOf<Annotation>(elements = []), hasDefault = false, type = typeOf<Test>(), globalIndex = 0, indexInKind = 0, kind = 0)]), returnType = typeOf<Int>(), isSuspend = false, isPrimaryCtor = false, invoker = local fun <anonymous>(args: ArgumentsProviderV1): Any? {
    return args.v1Get(globalIndex = 0) as Test.<get-prop>()
  }
, suspendInvoker = null, inheritedFrom = null, typeParameters = arrayOf<TypeParameter>(elements = [])), setter = null, inheritedFrom = null)]), constructors = arrayOf<Function>(elements = [Function(packageNames = arrayOf<String>(elements = ["auto", "implementation", "box"]), classNames = arrayOf<String>(elements = ["Test"]), name = "<init>", isAbstract = false, kotlin = ::Test, annotations = arrayOf<Annotation>(elements = []), parameters = arrayOf<Param>(elements = []), returnType = typeOf<Test>(), isSuspend = false, isPrimaryCtor = true, invoker = local fun <anonymous>(args: ArgumentsProviderV1): Any? {
    return Test()
  }
, suspendInvoker = null, inheritedFrom = null, typeParameters = arrayOf<TypeParameter>(elements = []))]), sealedSubclasses = null, cast = local fun <anonymous>(it: Any): Test {
    return it as Test
  }
, isInstance = local fun <anonymous>(it: Any): Boolean {
    return it is Test
  }
, safeCast = local fun <anonymous>(it: Any): Test? {
    return it as? Test
  }
, objectInstance = null, companionObject = null, typeParameters = arrayOf<TypeParameter>(elements = [])).toModel()
  assertEquals<TestAnnotation?>(expected = TestAnnotation(a = 1), actual = annotation<TestAnnotation>(/* <this> = spekt */), message = "Test annotation should be present")
  val prop: Property = single<Property>(/* <this> = spekt.<get-properties>() */)
  assertEquals<TestAnnotation?>(expected = TestAnnotation(a = 2), actual = annotation<TestAnnotation>(/* <this> = prop */), message = "Property annotation should be present")
  assertEquals<ExternalAnnotation?>(expected = ExternalAnnotation(name = "test", type = List<*>::class), actual = annotation<ExternalAnnotation>(/* <this> = prop */), message = "External annotation should be present")
  val test: SimpleFunction = single<SimpleFunction>(/* <this> = spekt.<get-declaredFunctions>() */)
  val testA: Parameter = last<Parameter>(/* <this> = test.<get-parameters>() */)
  assertEquals<TestAnnotation?>(expected = TestAnnotation(a = 3), actual = annotation<TestAnnotation>(/* <this> = testA */), message = "Parameter annotation should be present")
  return "OK"
}
